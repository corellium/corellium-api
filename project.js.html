<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>project.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Agent.html">Agent</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Agent.html#appList">appList</a></li><li data-type='method' style='display: none;'><a href="Agent.html#changeFileAttributes">changeFileAttributes</a></li><li data-type='method' style='display: none;'><a href="Agent.html#connectToWifi">connectToWifi</a></li><li data-type='method' style='display: none;'><a href="Agent.html#crashes">crashes</a></li><li data-type='method' style='display: none;'><a href="Agent.html#deleteFile">deleteFile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#disableSSLPinning">disableSSLPinning</a></li><li data-type='method' style='display: none;'><a href="Agent.html#disableUIAutomation">disableUIAutomation</a></li><li data-type='method' style='display: none;'><a href="Agent.html#disconnect">disconnect</a></li><li data-type='method' style='display: none;'><a href="Agent.html#disconnectFromWifi">disconnectFromWifi</a></li><li data-type='method' style='display: none;'><a href="Agent.html#download">download</a></li><li data-type='method' style='display: none;'><a href="Agent.html#enableSSLPinning">enableSSLPinning</a></li><li data-type='method' style='display: none;'><a href="Agent.html#enableUIAutomation">enableUIAutomation</a></li><li data-type='method' style='display: none;'><a href="Agent.html#getProfile">getProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#getProp">getProp</a></li><li data-type='method' style='display: none;'><a href="Agent.html#install">install</a></li><li data-type='method' style='display: none;'><a href="Agent.html#installFile">installFile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#installProfile">installProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#installProvisioningProfile">installProvisioningProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#isSSLPinningEnabled">isSSLPinningEnabled</a></li><li data-type='method' style='display: none;'><a href="Agent.html#kill">kill</a></li><li data-type='method' style='display: none;'><a href="Agent.html#listProvisioningProfiles">listProvisioningProfiles</a></li><li data-type='method' style='display: none;'><a href="Agent.html#lockDevice">lockDevice</a></li><li data-type='method' style='display: none;'><a href="Agent.html#network">network</a></li><li data-type='method' style='display: none;'><a href="Agent.html#preApproveProvisioningProfile">preApproveProvisioningProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#profileList">profileList</a></li><li data-type='method' style='display: none;'><a href="Agent.html#ready">ready</a></li><li data-type='method' style='display: none;'><a href="Agent.html#removeProfile">removeProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#removeProvisioningProfile">removeProvisioningProfile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#run">run</a></li><li data-type='method' style='display: none;'><a href="Agent.html#runActivity">runActivity</a></li><li data-type='method' style='display: none;'><a href="Agent.html#runFrida">runFrida</a></li><li data-type='method' style='display: none;'><a href="Agent.html#runFridaKill">runFridaKill</a></li><li data-type='method' style='display: none;'><a href="Agent.html#runFridaPs">runFridaPs</a></li><li data-type='method' style='display: none;'><a href="Agent.html#shellExec">shellExec</a></li><li data-type='method' style='display: none;'><a href="Agent.html#shutdown">shutdown</a></li><li data-type='method' style='display: none;'><a href="Agent.html#stat">stat</a></li><li data-type='method' style='display: none;'><a href="Agent.html#tempFile">tempFile</a></li><li data-type='method' style='display: none;'><a href="Agent.html#uninstall">uninstall</a></li><li data-type='method' style='display: none;'><a href="Agent.html#unlockDevice">unlockDevice</a></li><li data-type='method' style='display: none;'><a href="Agent.html#upload">upload</a></li></ul></li><li><a href="Corellium.html">Corellium</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Corellium.html#addProjectKey">addProjectKey</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#createProject">createProject</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#createRole">createRole</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#createUser">createUser</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#deleteProjectKey">deleteProjectKey</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#destroyRole">destroyRole</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#destroyUser">destroyUser</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#getProject">getProject</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#getTeam">getTeam</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#getTeamsAndUsers">getTeamsAndUsers</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#getToken">getToken</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#getUser">getUser</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#login">login</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#projectKeys">projectKeys</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#projectNamed">projectNamed</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#projects">projects</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#roles">roles</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#supported">supported</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#teams">teams</a></li><li data-type='method' style='display: none;'><a href="Corellium.html#users">users</a></li></ul></li><li><a href="Input.html">Input</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Input.html#delay">delay</a></li><li data-type='method' style='display: none;'><a href="Input.html#press">press</a></li><li data-type='method' style='display: none;'><a href="Input.html#pressRelease">pressRelease</a></li><li data-type='method' style='display: none;'><a href="Input.html#release">release</a></li><li data-type='method' style='display: none;'><a href="Input.html#swipeTo">swipeTo</a></li><li data-type='method' style='display: none;'><a href="Input.html#tap">tap</a></li><li data-type='method' style='display: none;'><a href="Input.html#touch">touch</a></li><li data-type='method' style='display: none;'><a href="Input.html#touchUp">touchUp</a></li></ul></li><li><a href="Instance.html">Instance</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Instance.html#agent">agent</a></li><li data-type='method' style='display: none;'><a href="Instance.html#clearCoreTraceFilter">clearCoreTraceFilter</a></li><li data-type='method' style='display: none;'><a href="Instance.html#clearCoreTraceLog">clearCoreTraceLog</a></li><li data-type='method' style='display: none;'><a href="Instance.html#clearPanics">clearPanics</a></li><li data-type='method' style='display: none;'><a href="Instance.html#console">console</a></li><li data-type='method' style='display: none;'><a href="Instance.html#consoleLog">consoleLog</a></li><li data-type='method' style='display: none;'><a href="Instance.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Instance.html#disableExposedPort">disableExposedPort</a></li><li data-type='method' style='display: none;'><a href="Instance.html#downloadCoreTraceLog">downloadCoreTraceLog</a></li><li data-type='method' style='display: none;'><a href="Instance.html#enableExposedPort">enableExposedPort</a></li><li data-type='method' style='display: none;'><a href="Instance.html#executeFridaScript">executeFridaScript</a></li><li data-type='method' style='display: none;'><a href="Instance.html#finishRestore">finishRestore</a></li><li data-type='method' style='display: none;'><a href="Instance.html#fridaConsole">fridaConsole</a></li><li data-type='method' style='display: none;'><a href="Instance.html#getCoreTraceThreadList">getCoreTraceThreadList</a></li><li data-type='method' style='display: none;'><a href="Instance.html#getPeripherals">getPeripherals</a></li><li data-type='method' style='display: none;'><a href="Instance.html#modifyBootOptions">modifyBootOptions</a></li><li data-type='method' style='display: none;'><a href="Instance.html#modifyPeripherals">modifyPeripherals</a></li><li data-type='method' style='display: none;'><a href="Instance.html#networkMonitor">networkMonitor</a></li><li data-type='method' style='display: none;'><a href="Instance.html#newAgent">newAgent</a></li><li data-type='method' style='display: none;'><a href="Instance.html#newNetworkMonitor">newNetworkMonitor</a></li><li data-type='method' style='display: none;'><a href="Instance.html#panics">panics</a></li><li data-type='method' style='display: none;'><a href="Instance.html#pause">pause</a></li><li data-type='method' style='display: none;'><a href="Instance.html#rate">rate</a></li><li data-type='method' style='display: none;'><a href="Instance.html#reboot">reboot</a></li><li data-type='method' style='display: none;'><a href="Instance.html#rename">rename</a></li><li data-type='method' style='display: none;'><a href="Instance.html#sendInput">sendInput</a></li><li data-type='method' style='display: none;'><a href="Instance.html#setCoreTraceFilter">setCoreTraceFilter</a></li><li data-type='method' style='display: none;'><a href="Instance.html#snapshots">snapshots</a></li><li data-type='method' style='display: none;'><a href="Instance.html#start">start</a></li><li data-type='method' style='display: none;'><a href="Instance.html#startCoreTrace">startCoreTrace</a></li><li data-type='method' style='display: none;'><a href="Instance.html#stop">stop</a></li><li data-type='method' style='display: none;'><a href="Instance.html#stopCoreTrace">stopCoreTrace</a></li><li data-type='method' style='display: none;'><a href="Instance.html#takeScreenshot">takeScreenshot</a></li><li data-type='method' style='display: none;'><a href="Instance.html#takeSnapshot">takeSnapshot</a></li><li data-type='method' style='display: none;'><a href="Instance.html#unpause">unpause</a></li><li data-type='method' style='display: none;'><a href="Instance.html#waitForState">waitForState</a></li></ul></li><li><a href="NetworkMonitor.html">NetworkMonitor</a><ul class='methods'><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#clearLog">clearLog</a></li><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#disconnect">disconnect</a></li><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#handleMessage">handleMessage</a></li><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#isEnabled">isEnabled</a></li><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#start">start</a></li><li data-type='method' style='display: none;'><a href="NetworkMonitor.html#stop">stop</a></li></ul></li><li><a href="Project.html">Project</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Project.html#addKey">addKey</a></li><li data-type='method' style='display: none;'><a href="Project.html#createInstance">createInstance</a></li><li data-type='method' style='display: none;'><a href="Project.html#createRole">createRole</a></li><li data-type='method' style='display: none;'><a href="Project.html#deleteKey">deleteKey</a></li><li data-type='method' style='display: none;'><a href="Project.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Project.html#getInstance">getInstance</a></li><li data-type='method' style='display: none;'><a href="Project.html#getToken">getToken</a></li><li data-type='method' style='display: none;'><a href="Project.html#instances">instances</a></li><li data-type='method' style='display: none;'><a href="Project.html#keys">keys</a></li><li data-type='method' style='display: none;'><a href="Project.html#refresh">refresh</a></li><li data-type='method' style='display: none;'><a href="Project.html#roles">roles</a></li><li data-type='method' style='display: none;'><a href="Project.html#setQuotas">setQuotas</a></li><li data-type='method' style='display: none;'><a href="Project.html#uploadImage">uploadImage</a></li><li data-type='method' style='display: none;'><a href="Project.html#vpnConfig">vpnConfig</a></li></ul></li><li><a href="Role.html">Role</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Role.html#destroy">destroy</a></li></ul></li><li><a href="Snapshot.html">Snapshot</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Snapshot.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="Snapshot.html#rename">rename</a></li><li data-type='method' style='display: none;'><a href="Snapshot.html#restore">restore</a></li></ul></li><li><a href="Team.html">Team</a></li><li><a href="User.html">User</a><ul class='methods'><li data-type='method' style='display: none;'><a href="User.html#destroy">destroy</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="Instance.html#event:change">change</a></li><li><a href="Instance.html#event:panic">panic</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AppListEntry">AppListEntry</a></li><li><a href="global.html#CommandResult">CommandResult</a></li><li><a href="global.html#FridaPsResult">FridaPsResult</a></li><li><a href="global.html#I">I</a></li><li><a href="global.html#NetmonEntry">NetmonEntry</a></li><li><a href="global.html#PanicInfo">PanicInfo</a></li><li><a href="global.html#PeripheralData">PeripheralData</a></li><li><a href="global.html#ProjectKey">ProjectKey</a></li><li><a href="global.html#ProjectQuotas">ProjectQuotas</a></li><li><a href="global.html#ProvisioningProfileInfo">ProvisioningProfileInfo</a></li><li><a href="global.html#RateInfo">RateInfo</a></li><li><a href="global.html#ShellExecResult">ShellExecResult</a></li><li><a href="global.html#StatEntry">StatEntry</a></li><li><a href="global.html#SupportedDevice">SupportedDevice</a></li><li><a href="global.html#ThreadInfo">ThreadInfo</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">project.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

const { fetchApi } = require("./util/fetch");
const Instance = require("./instance");
const InstanceUpdater = require("./instance-updater");
const uuidv4 = require("uuid/v4");
const Resumable = require("../resumable");
const util = require("util");
const fs = require("fs");
const path = require("path");

class File {
    constructor({ filePath, type, size }) {
        this.path = filePath;
        this.name = path.basename(filePath);
        this.type = type;
        this.size = size;
    }

    slice(start, end, _contentType) {
        return fs.createReadStream(this.path, { start, end });
    }
}

/**
 * @typedef {object} ProjectKey
 * @property {string} identifier
 * @property {string} label
 * @property {string} key
 * @property {'ssh'|'adb'} kind - public key
 * @property {string} fingerprint
 * @property {string} createdAt - ISO datetime string
 * @property {string} updatedAt - ISO datetime string
 */

/**
 * @typedef {object} ProjectQuotas
 * @property {number} cores - Number of available CPU cores
 */

/**
 * Instances of this class are returned from {@link Corellium#projects}, {@link
 * Corellium#getProject}, and {@link Corellium#projectNamed}. They should not
 * be created using the constructor.
 * @hideconstructor
 */
class Project {
    constructor(client, id) {
        this.client = client;
        this.api = this.client.api;
        this.id = id;
        this.token = null;
        this.updater = new InstanceUpdater(this);
    }

    /**
     * Reload the project info. This currently consists of name and quotas, but
     * will likely include more in the future.
     * @example
     * project.refresh();
     */
    async refresh() {
        this.info = await fetchApi(this, `/projects/${this.id}`);
    }

    /**
     * Returns refreshed authentication token
     * @return {string} token
     * @example
     * let token = await project.getToken()
     */
    async getToken() {
        return await this.client.getToken();
    }

    /**
     * Returns an array of the {@link Instance}s in this project.
     * @returns {Promise&lt;Instance[]>} The instances in this project
     * @example &lt;caption>Finding the first instance with a given name&lt;/caption>
     * const instances = await project.instances();
     * const instance = instances.find(instance => instance.name === 'Test Device');
     */
    async instances() {
        const instances = await fetchApi(this, `/projects/${this.id}/instances`);
        return await Promise.all(instances.map((info) => new Instance(this, info)));
    }

    /**
     * Returns the {@link Instance} with the given ID.
     * @param {string} id
     * @returns {Promise&lt;Instance>}
     * @example
     * await project.getInstance('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa');
     */
    async getInstance(id) {
        const info = await fetchApi(this, `/instances/${id}`);
        return new Instance(this, info);
    }

    /**
     * Creates an instance and returns the {@link Instance} object. The options
     * are passed directly to the API.
     *
     * @param {Object} options - The options for instance creation. These are
     * the same as the JSON options passed to the instance creation API
     * endpoint. For a full list of possible options, see the API documentation.
     * @param {string} options.flavor - The device flavor, such as `iphone6`
     * @param {string} options.os - The device operating system version
     * @param {string} options.ipsw - The ID of a previously uploaded image in the project to use as the firmware
     * @param {string} options.osbuild - The device operating system build
     * @param {string} [options.name] - The device name
     * @param {string} [options.patches] - Instance patches, such as `jailbroken` (default), `nonjailbroken` or `corelliumd` which is non-jailbroken with API agent.
     * @param {Object} [options.bootOptions] - Boot options for the instance
     * @param {string} [options.bootOptions.kernelSlide] - Change the Kernel slide value for an iOS device.
     * When not set, the slide will default to zero. When set to an empty value, the slide will be randomized.
     * @param {string} [options.bootOptions.udid] - Predefined Unique Device ID (UDID) for iOS device
     * @param {string} [options.bootOptions.screen] - Change the screen metrics for Ranchu devices `XxY[:DPI]`, e.g. `720x1280:280`
     * @param {string[]} [options.bootOptions.additionalTags] - Addition features to utilize for the device, valid options include:&lt;br>
     * `kalloc` : Enable kalloc/kfree trace access via GDB (Enterprise only)&lt;br>
     * `gpu` : Enable cloud GPU acceleration (Extra costs incurred, cloud only)
     * @returns {Promise&lt;Instance>}
     *
     * @example &lt;caption>Creating an instance and waiting for it to start its first boot&lt;/caption>
     * const instance = await project.createInstance({
     *     flavor: 'iphone6',
     *     os: '11.3',
     *     name: 'Test Device',
     *     osbuild: '15E216',
     *     patches: 'corelliumd',
     *     bootOptions: {
     *         udid: 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
     *     },
     * });
     * await instance.finishRestore();
     */
    async createInstance(options) {
        const { id } = await fetchApi(this, "/instances", {
            method: "POST",
            json: Object.assign({}, options, { project: this.id }),
        });
        return await this.getInstance(id);
    }

    /**
     * Get the VPN configuration to connect to the project network. This is only
     * available for cloud. At least one instance must be on in the project.
     *
     * @param {string} type -       Could be either "ovpn" or "tblk" to select between OpenVPN and TunnelBlick configuration formats.
     *                              TunnelBlick files are delivered as a ZIP file and OpenVPN configuration is just a text file.
     * @param {string} clientUUID - An arbitrary UUID to uniquely associate this VPN configuration with so it can be later identified
     *                              in a list of connected clients. Optional.
     * @returns {Promise&lt;Buffer>}
     * @example
     * await project.vpnConfig('ovpn', undefined)
     */
    async vpnConfig(type = "ovpn", clientUUID) {
        if (!clientUUID) clientUUID = uuidv4();

        const response = await fetchApi(
            this,
            `/projects/${this.id}/vpn-configs/${clientUUID}.${type}`,
            { response: "raw" },
        );
        return await response.buffer();
    }

    /** Destroy this project.
     * @example
     * project.destroy();
     */
    async destroy() {
        return await fetchApi(this, `/projects/${this.id}`, {
            method: "DELETE",
        });
    }

    /**
     * The project quotas.
     * @returns {ProjectQuotas}
     * @example
     * // Create map of supported devices.
     * let supported = {};
     * (await corellium.supported()).forEach(modelInfo => {
     *     supported[modelInfo.name] = modelInfo;
     * });
     *
     * // Get how many CPUs we're currently using.
     * let cpusUsed = 0;
     * instances.forEach(instance => {
     *     cpusUsed += supported[instance.flavor].quotas.cpus;
     * });
     *
     * console.log('Used: ' + cpusUsed + '/' + project.quotas.cpus);
     */
    get quotas() {
        return this.info.quotas;
    }

    set quotas(quotas) {
        this.setQuotas(quotas);
    }

    /**
     * Sets the project quotas. Only the cores property is currently respected.
     *
     * @param {ProjectQuotas} quotas
     */
    async setQuotas(quotas) {
        this.info.quotas = Object.assign({}, this.info.quotas, quotas);
        await fetchApi(this, `/projects/${this.id}`, {
            method: "PATCH",
            json: {
                quotas: {
                    cores: quotas.cores || quotas.cpus,
                },
            },
        });
    }

    /**
     * How much of the project's quotas are currently used. To ensure this information is up to date, call {@link Project#refresh()} first.
     * @property {number} cores - Number of used CPU cores
     * @example
     * project.quotasUsed();
     */
    get quotasUsed() {
        return this.info.quotasUsed;
    }

    /** The project's name.
     * @example
     * project.name();
     */
    get name() {
        return this.info.name;
    }

    /**
     * Returns a list of {@link Role}s associated with this project, showing who has permissions over this project.
     *
     * This function is only available to domain and project administrators.
     * @return {Role[]}
     * @example
     * await project.roles();
     */
    async roles() {
        const roles = await this.client.roles();
        return roles.get(this.id);
    }

    /**
     * Give permissions to this project for a {@link Team} or a {@link User} (adds a {@link Role}).
     *
     * This function is only available to domain and project administrators.
     * @param {User|Team} grantee - must be an instance of {@link User} or {@link Team}
     * @param {string} type - user ID
     * @example
     * project.createRole(grantee, 'user');
     */
    async createRole(grantee, type = "user") {
        await this.client.createRole(this.id, grantee, type);
    }

    /**
     * Returns a list of authorized keys associated with the project. When a new
     * instance is created in this project, its authorized_keys (iOS) or adbkeys
     * (Android) will be populated with these keys by default. Adding or
     * removing keys from the project will have no effect on existing instances.
     *
     * @returns {Promise&lt;ProjectKey[]>}
     * @example
     * let keys = project.keys();
     * for(let key of keys)
     *   console.log(key);
     */
    async keys() {
        return await this.client.projectKeys(this.id);
    }

    /**
     * Add a public key to project.
     *
     * @param {string} key - the public key, as formatted in a .pub file
     * @param {'ssh'|'adb'} kind
     * @param {string} [label] - defaults to the public key comment, if present
     *
     * @returns {Promise&lt;ProjectKey>}
     * @example
     * project.addKey(key, 'ssh', 'SSH Key');
     */
    async addKey(key, kind = "ssh", label = null) {
        return await this.client.addProjectKey(this.id, key, kind, label);
    }

    /**
     * Delete public key from the project
     * @param {string} keyId
     * @example
     * project.deleteKey('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa');
     */
    async deleteKey(keyId) {
        return await this.client.deleteProjectKey(this.id, keyId);
    }

    /**
     * Add an image to the project. These images may be removed at any time and are meant to facilitate creating a new Instance with images.
     *
     * @param {string} id - UUID of the image to create. Required to be universally unique but can be user-provided. You may resume uploads if you provide the same UUID.
     * @param {string} type - E.g. fw for the main firmware image.
     * @param {string} path - The path on the local file system to get the file.
     * @param {string} name - The name of the file to identify the file on the server. Usually the basename of the path.
     * @param {Project~progressCallback} [progress] - The callback for file upload progress information.
     *
     * @returns {Promise&lt;ProjectKey>}
     */
    async uploadImage(id, type, path, name, progress) {
        const token = await this.getToken();
        return new Promise((resolve, reject) => {
            const url =
                this.api +
                "/projects/" +
                encodeURIComponent(this.id) +
                "/image-upload/" +
                encodeURIComponent(type) +
                "/" +
                encodeURIComponent(id) +
                "/" +
                encodeURIComponent(name);
            const r = new Resumable({
                target: url,
                headers: {
                    Authorization: token,
                },
                uploadMethod: "PUT",
                chunkSize: 5 * 1024 * 1024,
                prioritizeFirstAndLastChunk: true,
                method: "octet",
            });

            r.on("fileAdded", (_file, _evt) => {
                r.upload();
            });

            r.on("progress", () => {
                if (progress) progress(r.progress());
            });

            r.on("fileError", (a, b) => {
                console.log("gadgsa", a, b);
                reject();
            });

            r.on("fileSuccess", () => {
                resolve();
            });

            return util
                .promisify(fs.stat)(path)
                .then((stat) => {
                    const file = new File({
                        filePath: path,
                        type: "application/octet-stream",
                        size: stat.size,
                    });
                    r.addFile(file);
                });
        });
    }
}

module.exports = Project;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Mon Aug 23 2021 23:37:05 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
